<UserControl x:Class="GGs.Desktop.Views.DashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:controls="clr-namespace:GGs.Desktop.Views.Controls">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="0,0,20,0">
            
            <!-- Welcome Header -->
            <Border Style="{StaticResource ModernCard}" Margin="0,0,0,20">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0">
                        <TextBlock x:Name="WelcomeText" Text="Welcome back, Admin!" 
                                   FontSize="24" FontWeight="Bold" 
                                   Foreground="{StaticResource TextPrimaryBrush}"/>
                        <TextBlock x:Name="LastLoginText" Text="Last login: Today at 9:32 AM" 
                                   FontSize="14" Margin="0,4,0,0"
                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                        <TextBlock x:Name="SystemStatusText" Text="All systems operational" 
                                   FontSize="14" Margin="0,8,0,0"
                                   Foreground="{StaticResource SuccessBrush}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Button Content="Quick Optimize" Style="{StaticResource PrimaryButton}" 
                                Margin="0,0,12,0" Click="QuickOptimize_Click"/>
                        <Button Content="System Scan" Style="{StaticResource PrimaryButton}" 
                                Background="{StaticResource AccentBrush}" Click="SystemScan_Click"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Stats Cards Row -->
            <Grid Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <controls:StatCard x:Name="ActiveUsersCard" Grid.Column="0" 
                                   Title="Active Users" 
                                   Value="1,247" 
                                   Change="+12%" 
                                   IsPositive="True"
                                   Icon="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                                   Margin="0,0,10,0"/>
                
                <controls:StatCard x:Name="TweaksAppliedCard" Grid.Column="1" 
                                   Title="Tweaks Applied" 
                                   Value="3,421" 
                                   Change="+8%" 
                                   IsPositive="True"
                                   Icon="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
                                   Margin="5,0,5,0"/>
                
                <controls:StatCard x:Name="PerformanceGainCard" Grid.Column="2" 
                                   Title="Performance Gain" 
                                   Value="23.4%" 
                                   Change="+2.1%" 
                                   IsPositive="True"
                                   Icon="M13 10V3L4 14h7v7l9-11h-7z"
                                   Margin="5,0,5,0"/>
                
                <controls:StatCard x:Name="EliBotQueriesCard" Grid.Column="3" 
                                   Title="EliBot Queries" 
                                   Value="892" 
                                   Change="+15%" 
                                   IsPositive="True"
                                   Icon="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
                                   Margin="10,0,0,0"/>
            </Grid>

            <!-- Main Content Grid -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- EliBot Chat Section -->
                <Border Grid.Column="0" Grid.Row="0" Style="{StaticResource ModernCard}" 
                        Margin="0,0,20,20">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Width="24" Height="24" Fill="{StaticResource AccentBrush}" 
                                  Data="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                            <TextBlock Text="EliBot Assistant" FontSize="18" FontWeight="Bold" 
                                       Margin="12,0,0,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                            <Border Background="{StaticResource AccentBrush}" CornerRadius="12" 
                                    Padding="8,4" Margin="12,0,0,0">
                                <TextBlock Text="AI Powered" FontSize="12" FontWeight="Medium" 
                                           Foreground="White"/>
                            </Border>
                        </StackPanel>
                        
                        <!-- Chat History -->
                        <ScrollViewer x:Name="ChatScrollViewer" MaxHeight="200" 
                                      VerticalScrollBarVisibility="Auto" Margin="0,0,0,16">
                            <ItemsControl x:Name="ChatHistory" ItemsSource="{Binding ChatMessages}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <controls:ChatMessage Message="{Binding}" Margin="0,0,0,8"/>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        
                        <!-- Chat Input -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBox x:Name="ChatInput" Grid.Column="0" 
                                     Style="{StaticResource ModernTextBox}"
                             KeyDown="ChatInput_KeyDown"/>
                            
                            <Button x:Name="SendChatButton" Grid.Column="1" 
                                    Style="{StaticResource PrimaryButton}" 
                                    Content="Send" Margin="12,0,0,0" 
                                    Click="SendChat_Click"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Recent Activity -->
                <Border Grid.Column="1" Grid.Row="0" Grid.RowSpan="2" 
                        Style="{StaticResource ModernCard}">
                    <StackPanel>
                        <TextBlock Text="Recent Activity" FontSize="18" FontWeight="Bold" 
                                   Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,16"/>
                        
                        <controls:ActivityFeed x:Name="ActivityFeed"/>
                    </StackPanel>
                </Border>

                <!-- System Performance Chart -->
                <Border Grid.Column="0" Grid.Row="1" Style="{StaticResource ModernCard}">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="System Performance" FontSize="18" FontWeight="Bold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                            <ComboBox x:Name="PerformanceTimeRange" Margin="12,0,0,0" 
                                      SelectedIndex="0" SelectionChanged="PerformanceTimeRange_Changed">
                                <ComboBoxItem Content="Last 24 Hours"/>
                                <ComboBoxItem Content="Last 7 Days"/>
                                <ComboBoxItem Content="Last 30 Days"/>
                            </ComboBox>
                        </StackPanel>
                        
                        <controls:PerformanceChart x:Name="PerformanceChart" Height="250"/>
                    </StackPanel>
                </Border>
            </Grid>

            <!-- Quick Actions -->
            <Border Style="{StaticResource ModernCard}" Margin="0,20,0,0">
                <StackPanel>
                    <TextBlock Text="Quick Actions" FontSize="18" FontWeight="Bold" 
                               Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,16"/>
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <controls:QuickActionButton x:Name="CreateTweakQuickAction" Grid.Column="0" 
                                                    Title="Create Tweak" 
                                                    Description="Build custom optimization"
                                                    Icon="M12 4.5v15m7.5-7.5h-15"
                                                    Command="{Binding CreateTweakCommand}"/>
                        
                        <controls:QuickActionButton Grid.Column="1" 
                                                    Title="Manage Users" 
                                                    Description="Add or edit user accounts"
                                                    Icon="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"
                                                    Command="{Binding ManageUsersCommand}"/>
                        
                        <controls:QuickActionButton Grid.Column="2" 
                                                    Title="View Analytics" 
                                                    Description="Check performance metrics"
                                                    Icon="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                                                    Command="{Binding ViewAnalyticsCommand}"/>
                        
                        <controls:QuickActionButton Grid.Column="3" 
                                                    Title="System Health" 
                                                    Description="Run diagnostics check"
                                                    Icon="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
                                                    Command="{Binding SystemHealthCommand}"/>
                    </Grid>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
